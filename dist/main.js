(()=>{"use strict";const e=async e=>{const n=await fetch(`https://us-central1-involvement-api.cloudfunctions.net/capstoneApi/apps/3vnHMFG69E4WPq0bdrAl/comments?item_id=${e}`);return await n.text()},n=n=>{const t=document.querySelector(".comments-popup"),o=document.createElement("div");o.classList.add("popup-window"),o.innerHTML=`\n        <div class="popup-image">\n            <img src=${n.show.image.medium} alt="" class="movie-pop-image">\n            <span><i class="fa-solid fa-xmark remove-btn"></i></span>\n        </div>\n\n        <div class="popup-details">\n            <p class="movie-id">${n.show.id}</p>\n            <h1 class="popup-title">${n.show.name}</h1>\n            <ul class="popup-list">\n                <li>Genres: ${n.show.genres}</li>\n                <li>Runtime: ${n.show.runtime} mins</li>\n                <li>Rating: ${n.show.rating.average}</li>\n                <li>Language: ${n.show.language}</li>\n            </ul>\n        </div>\n\n        <div class="comments-section">\n            <div class="all-comments">\n                <h3 class="comments-header">Comments (2)</h3>\n                <div class="comment-text">\n                   \n                </div>\n            </div>\n            <div class="add-comment">\n                <h3>Add a comment</h3>\n                <form action="" class="comment-form">\n                    <input type="text" placeholder="Your name" class="name-input" required>\n                    <textarea name="" id="" cols="30" rows="10" placeholder="Your insights" class="comment-input" required></textarea>\n                    <button type="button" class="comment-button">Comment</button>\n                </form>\n            </div>\n        </div>\n    `,t.appendChild(o),document.querySelector(".remove-btn").addEventListener("click",(()=>{t.classList.remove("comments-popup-toggle"),location.reload()}));const i=document.querySelectorAll(".name-input"),a=i[i.length-1],s=document.querySelectorAll(".comment-input"),c=s[s.length-1],m=document.querySelectorAll(".comment-button");m[m.length-1].addEventListener("click",(async()=>{await(async(e,n,t)=>{const o=await fetch("https://us-central1-involvement-api.cloudfunctions.net/capstoneApi/apps/3vnHMFG69E4WPq0bdrAl/comments",{method:"POST",body:JSON.stringify({item_id:e,username:n,comment:t}),headers:{"Content-Type":"application/json"}});return await o.text()})(n.show.id,a.value,c.value),(async n=>{const t=await(async()=>await e(n))(),o=JSON.parse(t),i=document.querySelector(".comment-text"),a=document.querySelector(".comments-header");a.innerHTML="",o.length?a.innerHTML=`Comments (${o.length})`:a.innerHTML="Comments (0)",i.innerHTML="",o.forEach((e=>{const n=document.createElement("p");n.innerHTML=`${e.creation_date} ${e.username}: ${e.comment}`,i.appendChild(n)}))})(n.show.id)}));const l=document.querySelector(".comment-button").parentElement.parentElement.parentElement.previousElementSibling.firstElementChild.textContent;(async()=>{const n=await(async()=>await e(l))(),t=document.querySelector(".comment-text"),o=document.querySelector(".comments-header"),i=JSON.parse(n);i.length?o.innerHTML=`Comments (${i.length})`:o.innerHTML="Comments (0)",i.forEach((e=>{const n=document.createElement("p");n.innerHTML=`${e.creation_date} ${e.username}: ${e.comment}`,t.appendChild(n)}))})()},t=async e=>{await fetch("https://us-central1-involvement-api.cloudfunctions.net/capstoneApi/apps/3vnHMFG69E4WPq0bdrAl/likes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_id:e})})},o=async(e,n)=>{const t=await fetch("https://us-central1-involvement-api.cloudfunctions.net/capstoneApi/apps/3vnHMFG69E4WPq0bdrAl/likes"),o=(await t.json()).find((n=>n.item_id===e));o&&(n.textContent=o.likes)},i=document.querySelector(".movie-display"),a=(e,n,t)=>{const o=document.createElement(e);return o.innerHTML=n,o.className=t,o};(async()=>{await fetch("https://api.tvmaze.com/search/shows?q=girls").then((e=>e.json())).then((e=>e.forEach((e=>{const s=(e=>{const n=a("div","","movie-wrapper"),i=a("div","","image-container");i.style.backgroundImage=`url(${e.show.image.original})`,n.appendChild(i);const s=a("div","","name-and-like"),c=a("div",e.show.name,"movieName");s.append(c);const m=a("div","","movieLikes"),l=a("i","","icon-heart");m.appendChild(l);const d=a("div","0","likeCount");d.id=e.show.id,l.addEventListener("click",(()=>{t(d.id),o(d.id,d)})),o(d.id,d),m.appendChild(d),s.appendChild(m),n.appendChild(s);const r=a("div","","Reserve_and_comment_wrapper"),p=a("div","Reserve","Reserve_and_comment");r.appendChild(p);const u=a("div","comment","Reserve_and_comment");return r.appendChild(u),n.appendChild(r),n})(e);i.appendChild(s);const c=document.querySelectorAll(".Reserve_and_comment");c[c.length-1].addEventListener("click",(()=>{n(e),document.querySelector(".comments-popup").classList.add("comments-popup-toggle")}))}))))})(),t(),(()=>{const e=document.querySelector(".movie-display").childElementCount;document.querySelector(".item-count").innerHTML=e})()})();